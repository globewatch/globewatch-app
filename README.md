# Project NatureWatch App


- [Project NatureWatch App](#project-naturewatch-app)
  - [Required environment variables](#required-environment-variables)
  - [Development Workflow](#development-workflow)
  - [Deployment](#deployment)
    - [Test Site Deployment](#test-site-deployment)
    - [Demo Site Deployment](#demo-site-deployment)
  - [Dependency Management](#dependency-management)
  - [Tests](#tests)
  - [Development](#development)
    - [Backend](#backend)
    - [Frontend](#frontend)
      - [Commands](#commands)


## Development Workflow

### Feature Development and Bug Fixes
Feature or fix branches should be created off the `develop` branch. After development and initial testing are complete, feature branches are merged back into `develop`. Follow the naming convention of `feature/your-feature-name` or `bugfix/your-fix-name`

- `feature`: For adding, removing or modifying a feature, 
- `bugfix`: For fixing a bug
- `hotfix`: For quickly fixing critical issues, usually with a temporary solution
- `test`: For experimenting something which is not an issue

### Releases
When a set of features is ready for release, open a Pull Request to merge `develop` into `main`. Create a new GitHub Version from `main` and tag it with an appropriate version number.

## Deployment
We use fly.io configuration file to run the Test Suite and deploy apps. See `fly.toml` for more details.


### Test Site Deployment
The test site is automatically deployed on [Fly.io](https://fly.io) via GitHub Actions when changes are pushed to the `develop` branch.

### Demo Site Deployment
The demo site is automatically deployed on [Fly.io](https://fly.io) via GitHub Actions when changes are pushed to the `main` branch. This should be the result of merging a release branch into `main`.


## Dependency Management
Dependency updates are managed by **Dependabot**, which automatically opens pull requests for outdated `npm` packages in the develop branch on a weekly basis.



## Tests

To run Unit Tests with a coverage report:
```bash
pytest -m unittest --cov=app --cov-report=term-missing app/tests -vv
```

To run Integration tests:
```bash
pytest -m integration -vv app/tests
```

## Development

### Backend

The backend is a python webserver based on FastAPI.

A `.vscode` directory is included for development in VSCode. You can use the launch configurations to run the app.

Here are a few commands to get you started, assuming you are developing in a Linux environment.
```bash
# Make sure you are running Python 3.x
python -V # e.g. returns `Python 3.8.10`

# Create a virtual environment called '.venv'
python -m venv .venv

# Activate the virtual environment
source .venv/bin/activate

# Install the project's development dependencies
pip install -r app/requirements-dev.txt
```

### Frontend

The recommended IDE setup is [Visual Studio Code](https://code.visualstudio.com/) + [Volar extension](https://marketplace.visualstudio.com/items?itemName=Vue.volar).

Make sure you have an up-to-date version of [Node.js](https://nodejs.org/en/) installed:

```bash
node -v && npm -v
# e.g. returns:
# v18.14.2
# 9.5.0
```

Install the dependencies, then run the dev server:
```bash
cd frontend/naturewatch
npm install
npm run dev
```

- This project uses Vue 3 `<script setup>` SFCs, check out the [script setup docs](https://v3.vuejs.org/api/sfc-script-setup.html#sfc-script-setup) to learn more.
- Includes [vue-router](https://router.vuejs.org/) and [Pinia](https://pinia.vuejs.org/).
- In addition, [ESLint](https://eslint.org/), [Stylelint](https://stylelint.io/), and [Prettier](https://prettier.io/) are also included and are set to be executed automatically at runtime.
- Also, when the development server is executed, it is checked in real time by [vite-plugin-checker](https://github.com/fi3ework/vite-plugin-checker).

#### Commands

| Command       | Description                                            |
| ------------- | ------------------------------------------------------ |
| dev           | Start devserver.                                       |
| clean         | Clear devserver cache.                                 |
| type-check    | Check vue markup.                                      |
| lint          | Run ESLint and prettier.                               |
| lint:style    | Run Stylelint.                                         |
| test          | Run vitest                                             |
| test:unit     | Run Unit test                                          |
| coverage      | Output Coverage Report.                                |
| build         | Build for production.                                  |
| build:analyze | Execute Bundle Analyzer                                |
| build:clean   | Clear production build files.                          |
| build-only    | Build for production without checking. For Deploy use. |
| preview       | Run the program generated by the production build.     |

